<!DOCTYPE html>
<html lang="en">

<head>
  <title>Connect 4 Bot 7x7</title>
  <link rel="stylesheet" type="text/css" href="connect4bot7x7.css">
  <script src="events.js"></script>
</head>

<body>
  <h1 style='text-align: center'>7x7 Connect 4 Bot</h1>

  <div id = "board">
    <script>
      const ROWS = 7, COLS = 7;
      const board = document.getElementById("board");
      for (let c = 0; c < COLS; c++) {

        const column = document.createElement("div");
        column.innerHTML = `<div class='col' style='left: ${100 / COLS * c}%;'></div>`;

        column.onclick = async e => {
          e.preventDefault();
          const res = await fetch(`${URL}move?col=${c}`, {method: "GET"});
          const data = await res.json();
          console.log(data);

          const animation = document.createElement("style");
          animation.setAttribute("type", "text/css");
          animation.innerHTML = `@keyframes drop { 100% {top: ${75.75 - data.row * 10}vh} }`;

          const piece = document.createElement("span");
          piece.className = "piece";
          piece.setAttribute("style", "animation-name: drop");
          piece.appendChild(animation);
          document.body.appendChild(piece);
        };

        column.onmouseenter = async e => {
          e.preventDefault();
          const res = await fetch(`${URL}hover?col=${c}`, {method: "GET"});
          const data = await res.json();
          console.log(`Hovering over ${data.col} ${data.empty_slot}`);
        };

        board.appendChild(column);

        for (let r = 0; r < ROWS; r++) {
          const cell = document.createElement("span");
          cell.innerHTML = `<span class='cell' style='left: ${100 / COLS * c}%; top: ${100 / ROWS * r}%'></span>`;
          column.appendChild(cell);
        }
      }
    </script>
  </div>

  <div class="options-container">
    <button class="option" onclick="send_start_request('go-first')">Go First</button>
    <button class="option" onclick="send_start_request('go-second')">Go Second</button>
  </div>

  <div class="options-container" style="display: none">
    <button class="option" onclick="alert('Resigned')">Resign</button>
  </div>

<!--  <span class="piece"></span>-->
</body>

</html>
